<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="kr.or.nextit.backend.mapper.ReserveMapper">

    <!-- 의사 예약 목록 조회 -->
    <select id="getReserveList" resultType="kr.or.nextit.backend.model.Reserve">
        SELECT * FROM reserve r
        INNER JOIN doctors d
        ON r.doctor_no = d.doctor_no
        INNER JOIN users u
        ON r.user_no = u.user_no
        AND d.doctor_no = #{doctorNo}
    </select>

    <!-- 환자 예약 목록 조회 -->
    <select id="getUserReserveList" resultType="kr.or.nextit.backend.model.Reserve">
        select r.*
        , (select user_name from users where user_no = r.doctor_no) as doctor_name
        from reserve r
        inner join users u
        on r.user_no = u.user_no
        and u.user_no = #{userNo}
    </select>
</mapper>
